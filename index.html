<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title data-i18n="meta.title">TokenLens – Señales y predicción cripto</title>
  <meta name="description" content="App de señales y predicción cripto con modelos propios. Descargá TokenLens.">

  <!-- Canonical + hreflang -->
  <link rel="canonical" href="https://tokenlens.pages.dev/"/>
  <link rel="alternate" hreflang="es" href="https://tokenlens.pages.dev/?lang=es"/>
  <link rel="alternate" hreflang="en" href="https://tokenlens.pages.dev/?lang=en"/>
  <link rel="alternate" hreflang="pt" href="https://tokenlens.pages.dev/?lang=pt"/>
  <link rel="alternate" hreflang="x-default" href="https://tokenlens.pages.dev/"/>

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://tokenlens.pages.dev/">
  <meta property="og:title" content="TokenLens – Señales y predicción cripto">
  <meta property="og:description" content="App de señales y predicción cripto con modelos propios. Descargá TokenLens.">
  <meta property="og:image" content="https://tokenlens.pages.dev/assets/og-image.png">
  <!-- NUEVO -->
  <meta property="og:image:alt" content="TokenLens: señales cripto con modelos reales. Vista de dashboard con gráficos." />
  <meta property="og:site_name" content="TokenLens" />
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="TokenLens – Señales y predicción cripto">
  <meta name="twitter:description" content="App de señales y predicción cripto con modelos propios. Descargá TokenLens.">
  <meta name="twitter:image" content="https://tokenlens.pages.dev/assets/og-image.png">
  <!-- NUEVO -->
  <meta name="twitter:image:alt" content="TokenLens: señales cripto con modelos reales. Vista de dashboard con gráficos." />
  <meta name="theme-color" content="#0f131a">

  <!-- Icons / PWA -->
  <link rel="icon" href="assets/favicon.svg" type="image/svg+xml">
  <link rel="icon" href="assets/favicon.png" sizes="32x32" type="image/png">
  <link rel="apple-touch-icon" href="assets/apple-touch-icon.png">
  <link rel="manifest" href="assets/site.webmanifest">

  <!-- JSON-LD Organization (NUEVO) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "TokenLens",
    "url": "https://tokenlens.pages.dev/",
    "logo": {
      "@type": "ImageObject",
      "url": "https://tokenlens.pages.dev/assets/apple-touch-icon.png",
      "width": 180,
      "height": 180
    },
    "sameAs": [
      "https://x.com/tucuenta",
      "https://youtube.com/@tu",
      "https://t.me/tucanal"
    ]
  }
  </script>

  <!-- Estilos globales -->
  <link rel="stylesheet" href="assets/styles.css" />

  <!-- Header/Footer styles + social icons -->
  <style>
    /* ===== Header ===== */
    .site-nav{ background:rgba(255,255,255,.02); border-bottom:1px solid #1f2a44; }
    .nav-wrap{ display:flex; align-items:center; justify-content:space-between; padding:12px 0; gap:16px; }
    .site-brand{ display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text); font-weight:700; }
    .site-brand img{ width:24px; height:24px; }

    .site-links{ display:flex; gap:18px; align-items:center; }
    .site-links a{ color:var(--muted); text-decoration:none; padding:8px 10px; border-radius:10px; border:1px solid transparent; background:transparent; }
    .site-links a:hover{ color:#fff; border-color:#233251; background:#0f131a; }
    .site-links a.active, .site-links a[aria-current="page"]{ color:var(--text); border-color:#2a3a5c; background:#0f131a; position:relative; }
    .site-links a.active::after{ content:""; position:absolute; left:10px; right:10px; bottom:-7px; height:2px; background:linear-gradient(90deg,var(--primary),var(--accent)); border-radius:2px; }

    .nav-cta{ display:flex; align-items:center; gap:12px; }
    .btn{ display:inline-block; padding:10px 14px; border-radius:12px; border:1px solid #24324d; color:var(--text); text-decoration:none; background:#151922; }
    .btn:hover{ border-color:#2b3a5f; }
    .btn.primary{ background:linear-gradient(135deg,var(--primary),var(--accent)); border:0; color:#061018; font-weight:700; }

    .lang-wrap{ position:relative; }
    .lang-select{ appearance:none; -webkit-appearance:none; -moz-appearance:none; padding:10px 34px 10px 12px; border-radius:12px; background:#0f131a; color:var(--text); border:1px solid #24324d; }
    .lang-select:focus{ outline:2px solid var(--primary); outline-offset:2px; }
    .lang-wrap .chev{ position:absolute; right:10px; top:50%; transform:translateY(-50%); pointer-events:none; color:var(--muted); font-size:12px; }
    .sr-only{ position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    /* ===== Contenido home ===== */
    .hero{ display:grid; grid-template-columns:1.1fr 0.9fr; gap:24px; align-items:center; padding:40px 0 0; }
    .card{ background:#0f131a; border:1px solid #1f2430; border-radius:16px; padding:18px; }
    .features-grid{ display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:16px; }

    /* ===== Social icons (inline SVG, sin dependencias) ===== */
    .social{ display:flex; gap:12px; margin-top:8px; }
    .social a{
      position:relative; padding-left:28px; color:var(--muted); text-decoration:none;
    }
    .social a:hover{ color:#fff; }
    .social a::before{
      content:""; position:absolute; left:0; top:50%; transform:translateY(-50%);
      width:18px; height:18px; background-repeat:no-repeat; background-size:contain; background-position:center;
      opacity:.9;
    }
    /* X (Twitter) */
    .social a[data-icon="x"]::before{
      background-image:url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M3 3L21 21M21 3L3 21' stroke='%23cdd7ee' stroke-width='2.2' stroke-linecap='round'/></svg>");
    }
    /* YouTube */
    .social a[data-icon='yt']::before{
      background-image:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><rect x='2' y='6' width='20' height='12' rx='3' fill='%23cdd7ee'/><polygon points='10,9 16,12 10,15' fill='%230f131a'/></svg>\");
    }
    /* Telegram */
    .social a[data-icon='tg']::before{
      background-image:url(\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'><path d='M21 3L3 11l7 3 3 7 2-6 6-12z' fill='%23cdd7ee'/></svg>\");
    }

    /* ===== Aviso superior + bloqueo navegación mientras se prepara ===== */
    .notice{
      background:linear-gradient(90deg, rgba(79,70,229,.15), rgba(14,165,233,.12));
      border-bottom:1px solid #1f2a44; padding:10px 0; text-align:center;
    }
    .site-links a, .nav-cta .btn{ pointer-events:none; opacity:.55; filter:grayscale(35%); }

    @media (max-width:900px){
      .nav-wrap{ flex-wrap:wrap; }
      .site-links{ order:3; width:100%; justify-content:center; padding:8px 0; }
      .nav-cta{ order:2; margin-left:auto; }
      .hero{ grid-template-columns:1fr; }
      .features-grid{ grid-template-columns:1fr; }
    }
  </style>
</head>
<body>

  <!-- AVISO SUPERIOR: en preparación + fecha de preventa -->
  <div class="notice">
    <div class="container" data-i18n="pre.banner">
      En preparación: estamos terminando TokenLens. Preventa: mañana por la noche (9 de septiembre de 2025).
    </div>
  </div>

  <!-- HEADER -->
  <header class="site-nav">
    <div class="container nav-wrap">
      <a class="site-brand" href="index.html" data-keep-lang>
        <img src="assets/logo.svg" alt="TokenLens" onerror="this.style.display='none'">
        <span>TokenLens</span>
      </a>

      <nav class="site-links">
        <a href="index.html#features" data-keep-lang data-i18n="nav.features">Características</a>
        <a href="precios.html" data-keep-lang data-i18n="nav.pricing">Precios</a>
        <a href="docs/README.html" data-keep-lang data-i18n="nav.docs">Docs</a>
      </nav>

      <div class="nav-cta">
        <a class="btn" href="descarga.html" data-keep-lang data-i18n="nav.download">Descargar</a>
        <a class="btn primary" href="precios.html#buy" data-keep-lang data-i18n="nav.buy">Comprar licencia</a>

        <label for="lang" class="sr-only">Language</label>
        <div class="lang-wrap">
          <select id="lang" class="lang-select" aria-label="Language">
            <option value="es">Español</option>
            <option value="en">English</option>
            <option value="pt">Português</option>
          </select>
          <span class="chev" aria-hidden>▾</span>
        </div>
      </div>
    </div>
  </header>

  <!-- MAIN -->
  <main class="container" style="padding:24px 0 0">
    <section class="hero">
      <div>
        <span class="badge" style="display:inline-block;font-size:.75rem;font-weight:700;letter-spacing:.04em;padding:4px 8px;border-radius:999px;border:1px solid #233251;margin-bottom:8px;background:rgba(35,50,81,.35);color:#cdd7ee" data-i18n="pre.badge">EN PREPARACIÓN</span>

        <h1 data-i18n="pre.heading">TokenLens está en preparación</h1>

        <p class="muted" data-i18n="pre.expl">
          Estamos afinando la plataforma de señales cripto con modelos propios. Unifica datos multi-exchange, entrena LSTM por token y muestra probabilidad de entrada con reglas BUY/SELL.
        </p>

        <div class="card" style="margin-top:12px">
          <h3 style="margin-top:0" data-i18n="pre.what_title">¿Qué vas a encontrar?</h3>
          <ul style="margin:0 0 8px 18px;padding:0">
            <li data-i18n="pre.what_1">Panel en vivo con probabilidad de entrada por token.</li>
            <li data-i18n="pre.what_2">BUY/SELL con umbrales configurables y perfiles de riesgo.</li>
            <li data-i18n="pre.what_3">Señales exportables (CSV) y alertas (p. ej., Telegram).</li>
            <li data-i18n="pre.what_4">Primero Windows (.exe); luego Android/iOS.</li>
          </ul>
          <small class="muted" data-i18n="pre.note">Nota: requiere set inicial de datos y entrenamiento.</small>
        </div>

        <div class="card" style="margin-top:12px">
          <strong data-i18n="pre.sale_window">Preventa: mañana por la noche (9 de septiembre de 2025)</strong>
          <p class="muted" style="margin:6px 0 0" data-i18n="pre.sale_copy">
            Abrimos la preventa para los primeros usuarios y activamos descargas/planes desde este sitio.
          </p>
        </div>

        <!-- Botones visibles pero desactivados por CSS -->
        <div style="display:flex;gap:12px;margin-top:14px;flex-wrap:wrap">
          <a class="btn primary" href="descarga.html" data-keep-lang data-i18n="hero.cta_download">Descargar para Windows</a>
          <a class="btn" href="docs/README.html" data-keep-lang data-i18n="hero.cta_docs">Ver documentación</a>
        </div>
      </div>

      <div class="card">
        <h3 data-i18n="hero.widget.title">Qué ves en tiempo real</h3>
        <ul style="margin:0 0 8px 18px">
          <li data-i18n="hero.widget.li1">Prob. de entrada (ENTER) por token</li>
          <li data-i18n="hero.widget.li2">BUY/SELL con umbrales configurables</li>
          <li data-i18n="hero.widget.li3">Señales guardadas en CSV + Telegram</li>
        </ul>
        <small class="muted" data-i18n="hero.widget.note">Requiere datos/entrenamiento inicial.</small>
      </div>
    </section>

    <section id="features" style="margin-top:28px">
      <h2 data-i18n="features.title">Características</h2>
      <div class="features-grid">
        <div class="card" data-i18n="features.f1">Colector multi-exchange + VWAP</div>
        <div class="card" data-i18n="features.f2">Entrenador LSTM por token</div>
        <div class="card" data-i18n="features.f3">Predictor con prob. de entrada</div>
      </div>
    </section>

    <section id="docs" style="margin-top:36px">
      <h2 data-i18n="docs.title">Documentación</h2>
      <p class="muted" data-i18n="docs.blurb">Guías paso a paso para instalar, activar y operar.</p>
      <a class="btn" href="docs/README.html" data-keep-lang data-i18n="docs.btn">Abrir docs</a>
    </section>
  </main>

  <!-- FOOTER -->
  <footer class="site-footer">
    <div class="container footer-grid">
      <div class="footer-col">
        <a class="site-brand" href="index.html" data-keep-lang>
          <img src="assets/logo.svg" alt="TokenLens" onerror="this.style.display='none'">
          <span>TokenLens</span>
        </a>
        <p class="muted" data-i18n="footer.tagline">Señales cripto con modelos reales.</p>

        <div class="social">
          <a href="https://x.com/tucuenta"        data-icon="x"  target="_blank" rel="noopener">Twitter</a>
          <a href="https://instagram.com/tucuenta" data-icon="ig" target="_blank" rel="noopener">Instagram</a>
          <a href="https://t.me/tucanal"           data-icon="tg" target="_blank" rel="noopener">Telegram</a>
        </div>
      </div>

      <div class="footer-col">
        <h4 data-i18n="footer.product">Producto</h4>
        <ul class="footer-links">
          <li><a href="descarga.html" data-keep-lang data-i18n="nav.download">Descargar</a></li>
          <li><a href="precios.html" data-keep-lang data-i18n="nav.pricing">Precios</a></li>
          <li><a href="docs/README.html" data-keep-lang data-i18n="nav.docs">Docs</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4 data-i18n="footer.legal">Legal</h4>
        <ul class="footer-links">
          <li><a href="terminos.html" data-keep-lang data-i18n="footer.terms">Términos</a></li>
          <li><a href="privacidad.html" data-keep-lang data-i18n="footer.privacy">Privacidad</a></li>
          <li><a href="gracias.html" data-keep-lang data-i18n="footer.thanks">Gracias</a></li>
        </ul>
      </div>

      <div class="footer-col">
        <h4 data-i18n="footer.news.title">Novedades</h4>
        <p class="muted" data-i18n="footer.news.copy">Te avisamos muy de vez en cuando.</p>
        <form id="newsletter-form">
          <input id="nl-email" type="email" required placeholder="tu@email.com" class="nl-input">
          <button class="btn primary" type="submit" data-i18n="footer.news.btn">Suscribirme</button>
        </form>
      </div>
    </div>

    <div class="container legal-bar">
      <span class="muted small" data-i18n="footer.copy">© 2025 TokenLens</span>
      <span class="muted small">v1</span>
    </div>
  </footer>

  <!-- i18n + lang persist + active link + newsletter -->
  <script>
    const translations = {
      es: {
        "meta.title": "TokenLens – Señales y predicción cripto",
        "nav.features": "Características",
        "nav.pricing": "Precios",
        "nav.docs": "Docs",
        "nav.download": "Descargar",
        "nav.buy": "Comprar licencia",
        "hero.title": "Señales cripto con modelos reales, no humo.",
        "hero.subtitle": "TokenLens unifica datos multi-exchange, entrena LSTM por token y te da señales claras con probabilidad de entrada.",
        "hero.cta_download": "Descargar para Windows",
        "hero.cta_docs": "Ver documentación",
        "hero.widget.title": "Qué ves en tiempo real",
        "hero.widget.li1": "Prob. de entrada (ENTER) por token",
        "hero.widget.li2": "BUY/SELL con umbrales configurables",
        "hero.widget.li3": "Señales guardadas en CSV + Telegram",
        "hero.widget.note": "Requiere datos/entrenamiento inicial.",
        "features.title": "Características",
        "features.f1": "Colector multi-exchange + VWAP",
        "features.f2": "Entrenador LSTM por token",
        "features.f3": "Predictor con prob. de entrada",
        "docs.title": "Documentación",
        "docs.blurb": "Guías paso a paso para instalar, activar y operar.",
        "docs.btn": "Abrir docs",
        "footer.product": "Producto",
        "footer.legal": "Legal",
        "footer.terms": "Términos",
        "footer.privacy": "Privacidad",
        "footer.thanks": "Gracias",
        "footer.tagline": "Señales cripto con modelos reales.",
        "footer.news.title": "Novedades",
        "footer.news.copy": "Te avisamos muy de vez en cuando.",
        "footer.news.btn": "Suscribirme",
        "footer.copy": "© 2025 TokenLens",

        /* === PRE-LANZAMIENTO === */
        "pre.banner": "En preparación: estamos terminando TokenLens. Preventa: mañana por la noche (9 de septiembre de 2025).",
        "pre.badge": "EN PREPARACIÓN",
        "pre.heading": "TokenLens está en preparación",
        "pre.expl": "Estamos afinando la plataforma de señales cripto con modelos propios. Unifica datos multi-exchange, entrena LSTM por token y muestra probabilidad de entrada con reglas BUY/SELL.",
        "pre.what_title": "¿Qué vas a encontrar?",
        "pre.what_1": "Panel en vivo con probabilidad de entrada por token.",
        "pre.what_2": "BUY/SELL con umbrales configurables y perfiles de riesgo.",
        "pre.what_3": "Señales exportables (CSV) y alertas (p. ej., Telegram).",
        "pre.what_4": "Primero Windows (.exe); luego Android/iOS.",
        "pre.note": "Nota: requiere set inicial de datos y entrenamiento.",
        "pre.sale_window": "Preventa: mañana por la noche (9 de septiembre de 2025)",
        "pre.sale_copy": "Abrimos la preventa para los primeros usuarios y activamos descargas/planes desde este sitio."
      },
      en: {
        "meta.title": "TokenLens – Crypto signals & forecasting",
        "nav.features": "Features",
        "nav.pricing": "Pricing",
        "nav.docs": "Docs",
        "nav.download": "Download",
        "nav.buy": "Buy license",
        "hero.title": "Real models, real crypto signals.",
        "hero.subtitle": "TokenLens merges multi-exchange data, trains per-token LSTM and outputs clear entry probabilities.",
        "hero.cta_download": "Download for Windows",
        "hero.cta_docs": "Read documentation",
        "hero.widget.title": "Live panel",
        "hero.widget.li1": "Entry probability (ENTER) per token",
        "hero.widget.li2": "BUY/SELL with custom thresholds",
        "hero.widget.li3": "Signals saved to CSV + Telegram",
        "hero.widget.note": "Requires initial data/training.",
        "features.title": "Features",
        "features.f1": "Multi-exchange collector + VWAP",
        "features.f2": "Per-token LSTM trainer",
        "features.f3": "Predictor with entry probability",
        "docs.title": "Docs",
        "docs.blurb": "Step-by-step guides to install, activate and trade.",
        "docs.btn": "Open docs",
        "footer.product": "Product",
        "footer.legal": "Legal",
        "footer.terms": "Terms",
        "footer.privacy": "Privacy",
        "footer.thanks": "Thanks",
        "footer.tagline": "Real models. Real crypto signals.",
        "footer.news.title": "Newsletter",
        "footer.news.copy": "We’ll ping you rarely.",
        "footer.news.btn": "Subscribe",
        "footer.copy": "© 2025 TokenLens",

        /* === PRE-LAUNCH === */
        "pre.banner": "In preparation: we’re finishing TokenLens. Presale: tomorrow night (September 9, 2025).",
        "pre.badge": "UNDER CONSTRUCTION",
        "pre.heading": "TokenLens is in preparation",
        "pre.expl": "We’re fine-tuning our crypto signals platform with in-house models. It merges multi-exchange data, trains per-token LSTM, and surfaces entry probability with BUY/SELL rules.",
        "pre.what_title": "What will you get?",
        "pre.what_1": "Live panel with entry probability per token.",
        "pre.what_2": "BUY/SELL with configurable thresholds and risk profiles.",
        "pre.what_3": "Exportable signals (CSV) and alerts (e.g., Telegram).",
        "pre.what_4": "Windows (.exe) first; Android/iOS next.",
        "pre.note": "Note: requires an initial data set and training.",
        "pre.sale_window": "Presale: tomorrow night (September 9, 2025)",
        "pre.sale_copy": "We’ll open presale for early users and enable downloads/plans here."
      },
      pt: {
        "meta.title": "TokenLens – Sinais e previsão cripto",
        "nav.features": "Recursos",
        "nav.pricing": "Preços",
        "nav.docs": "Docs",
        "nav.download": "Baixar",
        "nav.buy": "Comprar licença",
        "hero.title": "Modelos reais, sinais cripto de verdade.",
        "hero.subtitle": "TokenLens une dados multi-exchange, treina LSTM por token e entrega probabilidade clara de entrada.",
        "hero.cta_download": "Baixar para Windows",
        "hero.cta_docs": "Ver documentação",
        "hero.widget.title": "O que você vê ao vivo",
        "hero.widget.li1": "Prob. de entrada (ENTER) por token",
        "hero.widget.li2": "BUY/SELL com limiares ajustáveis",
        "hero.widget.li3": "Sinais em CSV + Telegram",
        "hero.widget.note": "Requer dados/treinamento inicial.",
        "features.title": "Recursos",
        "features.f1": "Coletor multi-exchange + VWAP",
        "features.f2": "Treinador LSTM por token",
        "features.f3": "Previsor com prob. de entrada",
        "docs.title": "Documentação",
        "docs.blurb": "Guias passo a passo para instalar, ativar e operar.",
        "docs.btn": "Abrir docs",
        "footer.product": "Produto",
        "footer.legal": "Legal",
        "footer.terms": "Termos",
        "footer.privacy": "Privacidade",
        "footer.thanks": "Obrigado",
        "footer.tagline": "Sinais cripto com modelos reais.",
        "footer.news.title": "Novidades",
        "footer.news.copy": "Avisamos raramente.",
        "footer.news.btn": "Assinar",
        "footer.copy": "© 2025 TokenLens",

        /* === PRÉ-LANÇAMENTO === */
        "pre.banner": "Em preparação: estamos finalizando o TokenLens. Pré-venda: amanhã à noite (9 de setembro de 2025).",
        "pre.badge": "EM PREPARAÇÃO",
        "pre.heading": "TokenLens está em preparação",
        "pre.expl": "Estamos ajustando a plataforma de sinais cripto com modelos próprios. Une dados multi-exchange, treina LSTM por token e exibe probabilidade de entrada com regras BUY/SELL.",
        "pre.what_title": "O que você vai encontrar?",
        "pre.what_1": "Painel ao vivo com probabilidade de entrada por token.",
        "pre.what_2": "BUY/SELL com limiares configuráveis e perfis de risco.",
        "pre.what_3": "Sinais exportáveis (CSV) e alertas (ex.: Telegram).",
        "pre.what_4": "Primeiro Windows (.exe); depois Android/iOS.",
        "pre.note": "Obs.: requer conjunto inicial de dados e treinamento.",
        "pre.sale_window": "Pré-venda: amanhã à noite (9 de setembro de 2025)",
        "pre.sale_copy": "Abriremos a pré-venda para os primeiros usuários e ativaremos downloads/planos aqui."
      }
    };

    const $$ = (s,r=document)=>Array.from(r.querySelectorAll(s));

    const getLang = ()=>{
      const qs = new URLSearchParams(location.search).get('lang');
      const st = localStorage.getItem('lang');
      const nv = (navigator.language||'es').slice(0,2).toLowerCase();
      const src = (qs||st||nv);
      return src.startsWith('pt')?'pt': src.startsWith('en')?'en':'es';
    };

    const applyI18n = (lang)=>{
      const d = translations[lang] || translations.es;
      document.documentElement.setAttribute('lang', lang);
      if(d["meta.title"]) document.title = d["meta.title"];

      const metaDesc = document.querySelector('meta[name="description"]');
      if (metaDesc) {
        metaDesc.setAttribute('content',
          lang==='en' ? 'Crypto signals & forecasting app with in-house models. Download TokenLens.' :
          lang==='pt' ? 'App de sinais e previsão cripto com modelos próprios. Baixe TokenLens.' :
                        'App de señales y predicción cripto con modelos propios. Descargá TokenLens.'
        );
      }

      $$('[data-i18n]').forEach(el=>{
        const k = el.getAttribute('data-i18n');
        if (d[k]) el.textContent = d[k];
      });

      localStorage.setItem('lang', lang);
      const sel=document.getElementById('lang'); if(sel) sel.value=lang;
    };

    /* Mantiene rutas relativas y hashes desde cualquier página */
    const keepLang = (lang)=>{
      $$('a[data-keep-lang]').forEach(a=>{
        const href = a.getAttribute('href') || '';
        if (!href || href.startsWith('#') || /^https?:\/\//i.test(href) || href.startsWith('mailto:')) return;
        const url = new URL(href, location.href);
        url.searchParams.set('lang', lang);
        a.setAttribute('href', url.pathname.replace(/^\//,'') + url.search + (url.hash || ''));
      });
    };

    const markActive = ()=>{
      const here = (location.pathname.split('/').pop() || 'index.html').toLowerCase();
      const hash = location.hash || '';

      $$('.site-links a').forEach(a=>{
        const href = a.getAttribute('href') || '';
        const url = new URL(href, location.href);
        const file = (url.pathname.split('/').pop() || 'index.html').toLowerCase();
        let active = false;

        // Activa "Precios" o "Docs" cuando coincide el archivo
        if (file !== 'index.html' && file === here) active = true;

        // En home, activa "Características" sólo si estás en #features
        if (file === 'index.html' && here === 'index.html' && url.hash === '#features' && hash === '#features') {
          active = true;
        }

        a.classList.toggle('active', active);
        if (active) a.setAttribute('aria-current','page'); else a.removeAttribute('aria-current');
      });
    };

    // Newsletter: un solo listener; toma idioma actual al enviar
    function wireNewsletter(){
      const form = document.getElementById('newsletter-form');
      if (!form) return;
      form.addEventListener('submit', (e)=>{
        e.preventDefault();
        const lang = document.documentElement.getAttribute('lang') || getLang();
        const email = (document.getElementById('nl-email')?.value||'').trim();
        const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        if (!ok){
          alert(lang==='pt'?'Insira um e-mail válido': lang==='en'?'Enter a valid email':'Ingresá un email válido');
          return;
        }
        const url = new URL('gracias.html', location.href);
        url.searchParams.set('email', email);
        url.searchParams.set('lang', lang);
        location.href = url.toString();
      });
    }

    // init
    const initial=getLang();
    applyI18n(initial);
    keepLang(initial);
    markActive();
    wireNewsletter();

    document.getElementById('lang').addEventListener('change', e=>{
      const lang=e.target.value;
      applyI18n(lang);
      keepLang(lang);
      const url=new URL(location.href); url.searchParams.set('lang',lang);
      history.replaceState({},'',url);
      markActive();
    });

    window.addEventListener('hashchange', markActive);
  </script>
</body>
</html>
